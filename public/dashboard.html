<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>Dashboard - Macave Mining</title>

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #0a1f44;
      color: white;
      margin: 0;
      padding: 20px;
    }

    header {
      text-align: center;
      margin-bottom: 20px;
    }

    header h1 {
      color: #00bfff;
      font-size: 32px;
    }

    .saldo {
      background: #102c66;
      padding: 15px;
      border-radius: 10px;
      font-size: 20px;
      margin-bottom: 20px;
    }

    .plan {
      background: #102c66;
      padding: 15px;
      border-radius: 10px;
      margin-bottom: 15px;
    }

    button {
      background: #00bfff;
      border: none;
      padding: 10px 15px;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
    }

    button:hover {
      background: #009acd;
    }
  </style>
</head>
<body>

<header>
  <h1>MM â€¢ Macave Mining</h1>
</header>

<div class="saldo">
  ðŸ’° Saldo: <span id="balance">Carregando...</span> USD
</div>

<h2>ðŸ“¦ Planos DisponÃ­veis</h2>
<div id="plans"></div>

<script>
/* ======================
   CARREGAR SALDO
====================== */
async function loadBalance() {
  const res = await fetch("/api/balance");
  const data = await res.json();
  document.getElementById("balance").innerText = data.balance;
}

/* ======================
   CARREGAR PLANOS
====================== */
async function loadPlans() {
  const res = await fetch("/api/plans");
  const plans = await res.json();

  const container = document.getElementById("plans");
  container.innerHTML = "";

  plans.forEach(plan => {
    container.innerHTML += `
      <div class="plan">
        <h3>${plan.name}</h3>
        <p>PreÃ§o: $${plan.price}</p>
        <p>Lucro diÃ¡rio: ${plan.dailyProfit}%</p>
        <p>DuraÃ§Ã£o: ${plan.duration} dias</p>
        <button onclick="buyPlan('${plan._id}')">Comprar</button>
      </div>
    `;
  });
}

/* ======================
   COMPRAR PLANO
====================== */
async function buyPlan(planId) {
  const res = await fetch("/api/purchase", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      userId: "teste123",
      planId
    })
  });

  const data = await res.json();
  alert(data.message);
  loadBalance();
}

loadBalance();
loadPlans();
</script>

</body>
</html>
