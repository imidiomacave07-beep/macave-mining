<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>Dashboard - Macave Mining</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="logo">
  <span>MM</span> Macave Mining
</div>

<div class="card">
  <h2>Dashboard</h2>
  <p id="saldo">Saldo: 0 USD</p>
</div>

<div class="card">
  <h3>Planos de Minera√ß√£o</h3>
  <div id="plans"></div>
</div>

<div class="bottom-menu">
  <a href="#">‚õè<br>Minera√ß√£o</a>
  <a href="#">üí∞<br>Saques</a>
  <a href="/dashboard.html">üìä<br>Dashboard</a>
</div>

<script>
const userId = localStorage.getItem("userId");

async function loadPlans() {
  const res = await fetch("/api/plans");
  const plans = await res.json();

  document.getElementById("plans").innerHTML =
    plans.map(p => `
      <div class="card">
        <h4>${p.name}</h4>
        <p>Pre√ßo: $${p.price}</p>
        <p>Lucro di√°rio: ${p.dailyProfit}%</p>
        <p>Dura√ß√£o: ${p.duration} dias</p>
        <button onclick="buy('${p._id}')">Comprar</button>
      </div>
    `).join("");
}

async function buy(planId) {
  const res = await fetch("/api/purchase", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ userId, planId })
  });
  const data = await res.json();
  alert(data.message || "Plano comprado");
}

loadPlans();
</script>

</body>
</html>
